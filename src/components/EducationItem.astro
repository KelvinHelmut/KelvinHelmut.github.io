---
import { Image } from "astro:assets";
import type { ImageMetadata } from "astro";
import { ExternalLink } from "lucide-react";
import CertificateModal from "./CertificateModal";

interface Props {
    institution: string;
    degree: string;
    period: string;
    highlights?: string[];
    image?: ImageMetadata;
    certificateUrl?: string;
}

const { institution, degree, period, highlights, image, certificateUrl } =
    Astro.props;
---

<div class="mb-12 last:mb-0 group/edu">
    <div
        class="flex flex-col md:flex-row md:justify-between md:items-baseline mb-1"
    >
        <div class="flex items-center gap-3">
            <h3 class="text-base font-bold text-zinc-900 dark:text-zinc-100">
                {degree}
            </h3>
            {
                certificateUrl && (
                    <a
                        href={certificateUrl}
                        target="_blank"
                        rel="noopener noreferrer"
                        class="text-zinc-300 dark:text-zinc-600 hover:text-zinc-900 dark:hover:text-zinc-100 transition-colors"
                        title="Ver documento original"
                        aria-label={`Ver documento original de ${degree}`}
                    >
                        <ExternalLink size={14} />
                    </a>
                )
            }
        </div>
        <span
            class="text-[10px] font-bold text-zinc-400 dark:text-zinc-500 uppercase tracking-widest"
            >{period}</span
        >
    </div>
    <p class="text-sm font-semibold text-zinc-500 dark:text-zinc-400 mb-3">
        {institution}
    </p>

    {
        image && (
            <div class="relative mt-4 mb-6 overflow-hidden rounded-xl border border-zinc-100 dark:border-zinc-800 bg-zinc-50 dark:bg-zinc-900/50">
                <CertificateModal
                    client:visible
                    src={image.src}
                    alt={`${degree} certificate`}
                >
                    <Image
                        src={image}
                        alt={`${degree} certificate`}
                        loading="lazy"
                        class="w-full h-auto object-cover grayscale brightness-90 group-hover/edu:grayscale-0 group-hover/edu:brightness-100 transition-all duration-700 ease-in-out hover:scale-[1.02]"
                    />
                </CertificateModal>
            </div>
        )
    }

    {
        highlights && highlights.length > 0 && (
            <ul class="space-y-1">
                {highlights.map((item) => (
                    <li class="text-sm text-zinc-600 dark:text-zinc-400 flex gap-2 italic opacity-80">
                        <span class="text-zinc-300 dark:text-zinc-700 mt-1.5 w-1 h-1 rounded-full bg-current flex-shrink-0" />
                        <span>{item}</span>
                    </li>
                ))}
            </ul>
        )
    }
</div>
