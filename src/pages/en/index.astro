---
import Layout from "../../layouts/Layout.astro";
import FadeIn from "../../components/FadeIn";
import ScrollToTop from "../../components/ScrollToTop";
import ExperienceSection from "../../components/ExperienceSection";
import ProjectCard from "../../components/ProjectCard.astro";
import EducationItem from "../../components/EducationItem.astro";
import CourseItem from "../../components/CourseItem.astro";
import PlatziAchievement from "../../components/PlatziAchievement.astro";
import { getCollection, type CollectionEntry } from "astro:content";
import { useTranslations } from "../../i18n/utils";
import { ui } from "../../i18n/ui";
import { Image } from "astro:assets";
import profileImage from "../../assets/profile.png";
import { Mail, Phone, Github, Linkedin, MapPin } from "lucide-react";

const t = useTranslations("en");
const experience = (
    await getCollection("experience", (e: any) => e.data.locale === "en")
).sort((a: any, b: any) => (b.data.order || 0) - (a.data.order || 0)) as any;
const projects = (
    await getCollection("projects", (e: any) => e.data.locale === "en")
).sort((a: any, b: any) => (b.data.order || 0) - (a.data.order || 0)) as any;
const education = (
    await getCollection("education", (e: any) => e.data.locale === "en")
).sort((a: any, b: any) => (b.data.order || 0) - (a.data.order || 0)) as any;
const courses = (
    await getCollection("courses", (e: any) => e.data.locale === "en")
).sort((a: any, b: any) => (b.data.order || 0) - (a.data.order || 0)) as any;
---

<Layout title="Portfolio" description={t("hero.subtitle")}>
    <div slot="nav" class="hidden md:flex items-center gap-6">
        <a
            href="#experience"
            class="text-sm hover:text-zinc-500 transition-colors uppercase tracking-widest font-bold text-[10px]"
            >{t("nav.experience")}</a
        >
        <a
            href="#projects"
            class="text-sm hover:text-zinc-500 transition-colors uppercase tracking-widest font-bold text-[10px]"
            >{t("nav.projects")}</a
        >
        <a
            href="#education"
            class="text-sm hover:text-zinc-500 transition-colors uppercase tracking-widest font-bold text-[10px]"
            >{t("nav.education")}</a
        >
    </div>

    <section class="mt-12 mb-24">
        <FadeIn client:load>
            <div
                class="flex flex-col md:flex-row md:items-start justify-between gap-10 mb-10"
            >
                <div class="flex-grow">
                    <h1 class="text-4xl font-bold tracking-tight mb-4">
                        Kelvin Helmut
                    </h1>
                    <h2
                        class="text-xl text-zinc-500 dark:text-zinc-400 font-medium mb-6"
                    >
                        {t("hero.title")}
                    </h2>

                    <div
                        class="flex flex-wrap gap-y-3 gap-x-6 text-sm text-zinc-400 dark:text-zinc-500 font-medium"
                    >
                        <div class="flex items-center gap-1.5">
                            <MapPin size={14} />
                            <span>Arequipa, Peru</span>
                        </div>
                        <a
                            href="mailto:aek6.io@gmail.com"
                            class="flex items-center gap-1.5 hover:text-zinc-900 dark:hover:text-zinc-100 transition-colors"
                            aria-label={t("social.email")}
                        >
                            <Mail size={14} />
                            <span>aek6.io@gmail.com</span>
                        </a>
                        <a
                            href="tel:+51954733536"
                            class="flex items-center gap-1.5 hover:text-zinc-900 dark:hover:text-zinc-100 transition-colors"
                            aria-label={t("social.phone")}
                        >
                            <Phone size={14} />
                            <span>+51 954 733 536</span>
                        </a>
                        <div
                            class="flex flex-wrap items-center gap-4 pt-1 w-full"
                        >
                            <div class="flex items-center gap-4">
                                <a
                                    href="https://linkedin.com/in/kelvinhelmut"
                                    target="_blank"
                                    rel="noopener noreferrer"
                                    class="flex items-center gap-1.5 hover:text-zinc-900 dark:hover:text-zinc-100 transition-colors"
                                    aria-label={t("social.linkedin")}
                                >
                                    <Linkedin size={14} />
                                    <span>LinkedIn</span>
                                </a>
                                <a
                                    href="https://github.com/KelvinHelmut"
                                    target="_blank"
                                    rel="noopener noreferrer"
                                    class="flex items-center gap-1.5 hover:text-zinc-900 dark:hover:text-zinc-100 transition-colors"
                                    aria-label={t("social.github")}
                                >
                                    <Github size={14} />
                                    <span>GitHub</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex-shrink-0 group mx-auto md:mx-0">
                    <div class="relative w-32 h-32 md:w-40 md:h-40">
                        <div
                            class="absolute inset-0 bg-emerald-500/10 dark:bg-emerald-500/5 rounded-full scale-105 group-hover:scale-110 transition-transform duration-700 blur-xl"
                        >
                        </div>
                        <Image
                            src={profileImage}
                            alt="Kelvin Helmut"
                            loading="eager"
                            fetchpriority="high"
                            class="relative w-full h-full object-cover rounded-full shadow-2xl border border-zinc-100/50 dark:border-zinc-800/50 opacity-85 saturate-[0.7] brightness-95 group-hover:opacity-100 group-hover:saturate-100 group-hover:brightness-100 transition-all duration-700 ease-in-out group-hover:scale-110"
                        />
                    </div>
                </div>
            </div>
            <p
                class="text-lg text-zinc-600 dark:text-zinc-400 leading-relaxed max-w-2xl font-light"
            >
                {t("hero.subtitle")}
            </p>
        </FadeIn>
    </section>

    <section id="experience" class="mb-32">
        <FadeIn client:visible delay={0.2}>
            <h2
                class="text-[10px] font-black uppercase tracking-[0.2em] text-zinc-400 dark:text-zinc-500 mb-12 border-b border-zinc-100 dark:border-zinc-800 pb-4"
            >
                {t("section.experience")}
            </h2>
            <ExperienceSection
                client:visible
                items={experience}
                seeMoreLabel={t("button.seeMore")}
                seeLessLabel={t("button.seeLess")}
                certificateLabel={t("button.certificate")}
                translations={ui["en"]}
            />
        </FadeIn>
    </section>

    <section id="projects" class="mb-32">
        <FadeIn client:visible delay={0.3}>
            <h2
                class="text-[10px] font-black uppercase tracking-[0.2em] text-zinc-400 dark:text-zinc-500 mb-12 border-b border-zinc-100 dark:border-zinc-800 pb-4"
            >
                {t("section.projects")}
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                {
                    projects.length === 0 && (
                        <p class="col-span-full text-center text-zinc-500 italic">
                            More projects coming soon...
                        </p>
                    )
                }
                {
                    projects.map((project: any) => (
                        <ProjectCard
                            title={project.data.title}
                            description={project.data.description}
                            tags={project.data.tags}
                            link={project.data.link}
                            github={project.data.github}
                            image={project.data.image}
                            isProduction={project.data.isProduction}
                        />
                    ))
                }
            </div>
        </FadeIn>
    </section>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-16">
        <section id="education">
            <FadeIn client:visible delay={0.4}>
                <h2
                    class="text-[10px] font-black uppercase tracking-[0.2em] text-zinc-400 dark:text-zinc-500 mb-12 border-b border-zinc-100 dark:border-zinc-800 pb-4"
                >
                    {t("section.education")}
                </h2>
                <div class="space-y-8">
                    {
                        education.map((edu: any) => (
                            <EducationItem
                                institution={edu.data.institution}
                                degree={edu.data.degree}
                                period={edu.data.period}
                                highlights={edu.data.highlights}
                                image={edu.data.image}
                                certificateUrl={edu.data.certificateUrl}
                            />
                        ))
                    }
                </div>
            </FadeIn>
        </section>

        <section id="courses">
            <FadeIn client:visible delay={0.5}>
                <h2
                    class="text-[10px] font-black uppercase tracking-[0.2em] text-zinc-400 dark:text-zinc-500 mb-12 border-b border-zinc-100 dark:border-zinc-800 pb-4"
                >
                    {t("section.courses")}
                </h2>
                <div class="space-y-2">
                    {
                        courses.map((course: any) => (
                            <CourseItem
                                title={course.data.title}
                                platform={course.data.platform}
                                date={course.data.date}
                                link={course.data.link}
                                image={course.data.image}
                            />
                        ))
                    }
                </div>
                <PlatziAchievement
                    title={t("courses.platzi.title")}
                    subtitle={t("courses.platzi.subtitle")}
                    badge={t("courses.platzi.badge")}
                    link="https://platzi.com/p/kelvin.provincia/"
                />
            </FadeIn>
        </section>
    </div>
    <ScrollToTop client:load />
</Layout>
