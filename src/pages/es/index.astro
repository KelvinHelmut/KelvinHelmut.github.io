---
import Layout from "../../layouts/Layout.astro";
import FadeIn from "../../components/FadeIn";
import TimelineItem from "../../components/TimelineItem.astro";
import ProjectCard from "../../components/ProjectCard.astro";
import EducationItem from "../../components/EducationItem.astro";
import CourseItem from "../../components/CourseItem.astro";
import { getCollection, type CollectionEntry } from "astro:content";
import { useTranslations } from "../../i18n/utils";
import { Mail, Phone, Github, Linkedin, MapPin, Globe } from "lucide-react";

const t = useTranslations("es");
const experience: CollectionEntry<"experience">[] = (
    await getCollection(
        "experience",
        ({ data }: CollectionEntry<"experience">) => data.locale === "es"
    )
).sort(
    (a: CollectionEntry<"experience">, b: CollectionEntry<"experience">) =>
        (b.data.order || 0) - (a.data.order || 0)
);

const projects: CollectionEntry<"projects">[] = (
    await getCollection(
        "projects",
        ({ data }: CollectionEntry<"projects">) => data.locale === "es"
    )
).sort(
    (a: CollectionEntry<"projects">, b: CollectionEntry<"projects">) =>
        (b.data.order || 0) - (a.data.order || 0)
);

const education: CollectionEntry<"education">[] = (
    await getCollection(
        "education",
        ({ data }: CollectionEntry<"education">) => data.locale === "es"
    )
).sort(
    (a: CollectionEntry<"education">, b: CollectionEntry<"education">) =>
        (b.data.order || 0) - (a.data.order || 0)
);

const courses: CollectionEntry<"courses">[] = (
    await getCollection(
        "courses",
        ({ data }: CollectionEntry<"courses">) => data.locale === "es"
    )
).sort(
    (a: CollectionEntry<"courses">, b: CollectionEntry<"courses">) =>
        (b.data.order || 0) - (a.data.order || 0)
);
---

<Layout title="Portafolio" description={t("hero.subtitle")}>
    <div slot="nav">
        <a
            href="#experience"
            class="text-sm hover:text-zinc-500 transition-colors uppercase tracking-widest font-bold text-[10px]"
            >{t("nav.experience")}</a
        >
        <a
            href="#projects"
            class="text-sm hover:text-zinc-500 transition-colors uppercase tracking-widest font-bold text-[10px]"
            >{t("nav.projects")}</a
        >
        <a
            href="#education"
            class="text-sm hover:text-zinc-500 transition-colors uppercase tracking-widest font-bold text-[10px]"
            >{t("nav.education")}</a
        >
    </div>

    <section class="mt-12 mb-24">
        <FadeIn client:load>
            <h1 class="text-4xl font-bold tracking-tight mb-4">
                Kelvin Helmut
            </h1>
            <h2
                class="text-xl text-zinc-500 dark:text-zinc-400 font-medium mb-2"
            >
                {t("hero.title")}
            </h2>
            <div
                class="flex flex-wrap gap-y-2 gap-x-4 mb-8 text-sm text-zinc-400 dark:text-zinc-500 font-medium"
            >
                <div class="flex items-center gap-1.5">
                    <MapPin size={14} />
                    <span>Arequipa, Perú</span>
                </div>
                <a
                    href="mailto:aek6.io@gmail.com"
                    class="flex items-center gap-1.5 hover:text-zinc-900 dark:hover:text-zinc-100 transition-colors"
                >
                    <Mail size={14} />
                    <span>aek6.io@gmail.com</span>
                </a>
                <a
                    href="tel:+51954733536"
                    class="flex items-center gap-1.5 hover:text-zinc-900 dark:hover:text-zinc-100 transition-colors"
                >
                    <Phone size={14} />
                    <span>+51 954 733 536</span>
                </a>
                <a
                    href="https://linkedin.com/in/kelvinhelmut"
                    target="_blank"
                    class="flex items-center gap-1.5 hover:text-zinc-900 dark:hover:text-zinc-100 transition-colors border-l border-zinc-200 dark:border-zinc-800 pl-4"
                >
                    <Linkedin size={14} />
                    <span>LinkedIn</span>
                </a>
                <a
                    href="https://github.com/KelvinHelmut"
                    target="_blank"
                    class="flex items-center gap-1.5 hover:text-zinc-900 dark:hover:text-zinc-100 transition-colors"
                >
                    <Github size={14} />
                    <span>GitHub</span>
                </a>
                <a
                    href="https://kelvinhelmut.github.io/"
                    target="_blank"
                    class="flex items-center gap-1.5 hover:text-zinc-900 dark:hover:text-zinc-100 transition-colors"
                >
                    <Globe size={14} />
                    <span>kelvinhelmut.github.io</span>
                </a>
            </div>
            <p
                class="text-lg text-zinc-600 dark:text-zinc-400 leading-relaxed max-w-2xl font-light"
            >
                {t("hero.subtitle")}
            </p>
        </FadeIn>
    </section>

    <section id="experience" class="mb-32">
        <FadeIn client:load delay={0.2}>
            <h2
                class="text-[10px] font-black uppercase tracking-[0.2em] text-zinc-400 dark:text-zinc-500 mb-12 border-b border-zinc-100 dark:border-zinc-800 pb-4"
            >
                {t("section.experience")}
            </h2>
            <div class="space-y-0">
                {
                    experience.map((exp) => (
                        <TimelineItem
                            company={exp.data.company}
                            role={exp.data.role}
                            period={exp.data.period}
                            location={exp.data.location}
                            description={exp.data.description}
                            highlights={exp.data.highlights}
                            technologies={exp.data.technologies}
                        />
                    ))
                }
            </div>
        </FadeIn>
    </section>

    <section id="projects" class="mb-32">
        <FadeIn client:load delay={0.3}>
            <h2
                class="text-[10px] font-black uppercase tracking-[0.2em] text-zinc-400 dark:text-zinc-500 mb-12 border-b border-zinc-100 dark:border-zinc-800 pb-4"
            >
                {t("section.projects")}
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                {
                    projects.length === 0 && (
                        <p class="col-span-full text-center text-zinc-500 italic">
                            Próximamente más proyectos...
                        </p>
                    )
                }
                {
                    projects.map((project) => (
                        <ProjectCard
                            title={project.data.title}
                            description={project.data.description}
                            tags={project.data.tags}
                            link={project.data.link}
                            github={project.data.github}
                            image={project.data.image}
                            isProduction={project.data.isProduction}
                        />
                    ))
                }
            </div>
        </FadeIn>
    </section>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-16">
        <section id="education">
            <FadeIn client:load delay={0.4}>
                <h2
                    class="text-[10px] font-black uppercase tracking-[0.2em] text-zinc-400 dark:text-zinc-500 mb-12 border-b border-zinc-100 dark:border-zinc-800 pb-4"
                >
                    {t("section.education")}
                </h2>
                <div class="space-y-8">
                    {
                        education.map((edu) => (
                            <EducationItem
                                institution={edu.data.institution}
                                degree={edu.data.degree}
                                period={edu.data.period}
                                highlights={edu.data.highlights}
                                image={edu.data.image}
                                certificateUrl={edu.data.certificateUrl}
                            />
                        ))
                    }
                </div>
            </FadeIn>
        </section>

        <section id="courses">
            <FadeIn client:load delay={0.5}>
                <h2
                    class="text-[10px] font-black uppercase tracking-[0.2em] text-zinc-400 dark:text-zinc-500 mb-12 border-b border-zinc-100 dark:border-zinc-800 pb-4"
                >
                    {t("section.courses")}
                </h2>
                <div class="space-y-2">
                    {
                        courses.map((course) => (
                            <CourseItem
                                title={course.data.title}
                                platform={course.data.platform}
                                date={course.data.date}
                                link={course.data.link}
                                image={course.data.image}
                            />
                        ))
                    }
                </div>
            </FadeIn>
        </section>
    </div>
</Layout>
